<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./assets/logo/taekwondo-sbeitla.png" type="image/png" sizes="50x50">
    <title>Student Dashboard - Taekwondo Sbeitla</title>
    <link rel="stylesheet" href="./style.css">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <symbol id="icon-taekwondo" viewBox="0 0 24 24">
                <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2M15.9 8.1C15.5 7.7 14.8 7.7 14.4 8.1L12 10.5L9.6 8.1C9.2 7.7 8.5 7.7 8.1 8.1C7.7 8.5 7.7 9.2 8.1 9.6L10 11.5V15L8 20H10L12 16L14 20H16L14 15V11.5L15.9 9.6C16.3 9.2 16.3 8.5 15.9 8.1M6 18C6 18 4 13 4 11C4 9.9 4.9 9 6 9V18M18 18V9C19.1 9 20 9.9 20 11C20 13 18 18 18 18Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-dashboard" viewBox="0 0 24 24">
                <path d="M3 13H11V3H3M3 21H11V15H3M13 21H21V11H13M13 3V9H21V3" fill="currentColor"/>
            </symbol>
            <symbol id="icon-users" viewBox="0 0 24 24">
                <path d="M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-certificate" viewBox="0 0 24 24">
                <path d="M4 3C2.9 3 2 3.9 2 5V15C2 16.1 2.9 17 4 17H11V15H4V5H20V15H13V17H20C21.1 17 22 16.1 22 15V5C22 3.9 21.1 3 20 3H4M12 17L9 20V23L12 21L15 23V20L12 17Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-book" viewBox="0 0 24 24">
                <path d="M18 2H12V9L9.5 7.5L7 9V2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V4C20 2.9 19.1 2 18 2Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-message" viewBox="0 0 24 24">
                <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H6L4 18V4H20V16M7 9H17V11H7V9M7 6H17V8H7V6M7 12H14V14H7V12Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-family" viewBox="0 0 24 24">
                <path d="M16 4C16 2.9 16.9 2 18 2S20 2.9 20 4 19.1 6 18 6 16 5.1 16 4M6 4C6 2.9 6.9 2 8 2S10 2.9 10 4 9.1 6 8 6 6 5.1 6 4M12 8C11.4 8 11 8.4 11 9V11H9V9C9 8.4 8.6 8 8 8S7 8.4 7 9V15H9V22H11V15H13V22H15V15H17V9C17 8.4 16.6 8 16 8S15 8.4 15 9V11H13V9C13 8.4 12.6 8 12 8M4 9V15H6V22H8V9H4M16 9V22H18V15H20V9H16Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-calendar" viewBox="0 0 24 24">
                <path d="M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3 4.9 3 6V20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4M19 20H5V10H19V20M19 8H5V6H19V8M7 12H12V17H7V12Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-register" viewBox="0 0 24 24">
                <path d="M19 3H14.82C14.4 1.84 13.3 1 12 1S9.6 1.84 9.18 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M12 3C12.55 3 13 3.45 13 4S12.55 5 12 5 11 4.55 11 4 11.45 3 12 3M7 7H17V9H7V7M7 11H17V13H7V11M7 15H14V17H7V15Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-settings" viewBox="0 0 24 24">
                <path d="M12 15.5C10.07 15.5 8.5 13.93 8.5 12S10.07 8.5 12 8.5 15.5 10.07 15.5 12 13.93 15.5 12 15.5M19.43 12.97C19.47 12.65 19.5 12.33 19.5 12S19.47 11.35 19.43 11.03L21.54 9.37C21.73 9.22 21.78 8.95 21.66 8.73L19.66 5.27C19.54 5.05 19.27 4.96 19.05 5.05L16.56 6.05C16.04 5.66 15.5 5.5 14.78 5.65L13.5 3.6C13.36 3.39 13.12 3.28 12.88 3.28H11.12C10.88 3.28 10.64 3.39 10.5 3.6L9.22 5.65C8.5 5.5 7.96 5.66 7.44 6.05L4.95 5.05C4.73 4.96 4.46 5.05 4.34 5.27L2.34 8.73C2.22 8.95 2.27 9.22 2.46 9.37L4.57 11.03C4.53 11.35 4.5 11.67 4.5 12S4.53 12.65 4.57 12.97L2.46 14.63C2.27 14.78 2.22 15.05 2.34 15.27L4.34 18.73C4.46 18.95 4.73 19.04 4.95 18.95L7.44 17.95C7.96 18.34 8.5 18.5 9.22 18.35L10.5 20.4C10.64 20.61 10.88 20.72 11.12 20.72H12.88C13.12 20.72 13.36 20.61 13.5 20.4L14.78 18.35C15.5 18.5 16.04 18.34 16.56 17.95L19.05 18.95C19.27 19.04 19.54 18.95 19.66 18.73L21.66 15.27C21.78 15.05 21.73 14.78 21.54 14.63L19.43 12.97Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-logout" viewBox="0 0 24 24">
                <path d="M16 17V14H9V10H16V7L21 12L16 17M14 2C15.1 2 16 2.9 16 4V6H14V4H5V20H14V18H16V20C16 21.1 15.1 22 14 22H5C3.9 22 3 21.1 3 20V4C3 2.9 3.9 2 5 2H14Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-check" viewBox="0 0 24 24">
                <path d="M21 7L9 19L3.5 13.5L4.91 12.09L9 16.17L19.59 5.59L21 7Z" fill="currentColor"/>
            </symbol>
            <symbol id="icon-trophy" viewBox="0 0 24 24">
                <path d="M20 2H4V4C4 5.1 4.9 6 6 6V7C6 9.76 8.24 12 11 12V14.5C8.79 14.78 7 16.79 7 19H9C9 17.34 10.34 16 12 16S15 17.34 15 19H17C17 16.79 15.21 14.78 13 14.5V12C15.76 12 18 9.76 18 7V6C19.1 6 20 5.1 20 4V2M6 4H8V7C8 8.65 9.35 10 11 10V4H13V10C14.65 10 16 8.65 16 7V4H18V4C18 4.55 17.55 5 17 5H16V7C16 8.65 14.65 10 13 10C11.35 10 10 8.65 10 7V5H9C8.45 5 8 4.55 8 4H6V4Z" fill="currentColor"/>
            </symbol>
        </defs>
    </svg>
    
    <style>
        .announcement-image {
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .announcement-image:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        /* Image viewer modal */
        .image-viewer-modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            animation: fadeIn 0.3s;
        }
        
        .image-viewer-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-viewer-content {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
            animation: zoomIn 0.3s;
        }
        
        .image-viewer-close {
            position: absolute;
            top: 20px;
            right: 40px;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .image-viewer-close:hover {
            color: #f1f1f1;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes zoomIn {
            from { transform: scale(0.5); }
            to { transform: scale(1); }
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.3s ease;
        }

        .certificate-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .certificate-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .certificate-icon {
            font-size: 40px;
        }

        .certificate-info {
            flex: 1;
        }

        .certificate-info h4 {
            margin: 0 0 5px 0;
            color: var(--text-primary);
        }

        .certificate-info p {
            margin: 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .material-item {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .material-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .material-icon {
            font-size: 40px;
        }

        .material-info {
            flex: 1;
        }

        .material-info h4 {
            margin: 0 0 5px 0;
            color: var(--text-primary);
        }

        .material-info p {
            margin: 0 0 5px 0;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .view-all-link {
            text-align: center;
            margin-top: 15px;
        }

        .view-all-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .view-all-link a:hover {
            color: var(--primary-hover);
            text-decoration: underline;
        }
    </style>
    <link rel="stylesheet" href="./sponsors-carousel.css">
    <!-- Lottie Web for animated icons (AnimatedIcons) -->
    
</head>

<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo bounce-animation"><img class="logo-img" src="./assets/logo/taekwondo-sbeitla.png" alt="Taekwondo Sbeitla" /></div>
                <h2>Taekwondo Sbeitla</h2>
            </div>
            
            <nav class="sidebar-nav">
                <a href="student-dashboard.html" class="nav-item active">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-dashboard"/></svg></span>
                    <span>Dashboard</span>
                </a>
                <a href="student-certificates.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-certificate"/></svg></span>
                    <span>My Certificates</span>
                </a>
                <a href="student-materials.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-book"/></svg></span>
                    <span>Training Materials</span>
                </a>
                <a href="messages.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-message"/></svg></span>
                    <span>Messages</span>
                    <span class="message-badge" id="sidebarMessageBadge"></span>
                </a>
                <a href="class-schedule.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-calendar"/></svg></span>
                    <span>Schedule</span>
                </a>
                <a href="index.html" class="nav-item logout">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-logout"/></svg></span>
                    <span>Logout</span>
                </a>
            </nav>
        </aside>
        
        <main class="main-content">
            <header class="page-header">
                <h1><svg width="24" height="24" style="margin-right:8px; vertical-align:middle;"><use href="#icon-dashboard"/></svg>Student Dashboard</h1>
                <div class="user-info">
                    <span id="studentName">Welcome, Student</span>
                    <span class="online-indicator" title="You are online"><svg width="12" height="12"><use href="#icon-users"/></svg></span>
                </div>
            </header>
            
            <!-- Profile Section -->
            <div class="profile-section">
                <div class="profile-card">
                    <div class="profile-avatar" id="studentAvatar"><svg width="64" height="64"><use href="#icon-taekwondo"/></svg></div>
                    <div class="profile-info">
                        <h2 id="studentFullName">Student Name</h2>
                        <p class="belt-rank" id="studentBeltRank">White Belt</p>
                        <p class="member-since"><strong>Member Since:</strong> <span id="memberSince">January 2024</span></p>
                        <p class="student-class"><strong>Class:</strong> <span id="studentClass">Beginner</span></p>
                    </div>
                </div>
            </div>

            <!-- Statistics Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-check"/></svg></div>
                    <div class="stat-info">
                        <h3>Attendance Rate</h3>
                        <p class="stat-value" id="attendanceRate">0%</p>
                    </div>
                </div>
                
                <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-book"/></svg></div>
                    <div class="stat-info">
                        <h3>Training Materials</h3>
                        <p class="stat-value" id="materialsCount">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-certificate"/></svg></div>
                    <div class="stat-info">
                        <h3>Certificates</h3>
                        <p class="stat-value" id="certificatesCount">0</p>
                    </div>
                </div>
                
                <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-trophy"/></svg></div>
                    <div class="stat-info">
                        <h3>Next Belt Test</h3>
                        <p class="stat-value" id="nextBeltTest">TBD</p>
                    </div>
                </div>
            </div>

            <!-- Belt Progress -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-taekwondo"/></svg>My Belt Progress</h2>
                </div>
                <div class="card-body">
                    <p><strong>Current Belt:</strong> <span id="currentBelt">White Belt</span></p>
                    <p><strong>Next Belt:</strong> <span id="nextBelt">Yellow Belt</span></p>
                    <p><strong>Progress to Next Belt:</strong></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="beltProgress" style="width: 0%"></div>
                    </div>
                    <p style="margin-top: 10px; color: var(--text-secondary); font-size: 14px;">
                        Keep training to advance to the next level!
                    </p>
                </div>
            </div>
            
            <!-- Announcements Section -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-message"/></svg>Latest Announcements</h2>
                </div>
                <div class="card-body" id="announcementsList">
                    <p style="text-align: center; color: var(--text-secondary); padding: 20px;">No announcements yet</p>
                </div>
            </div>

            <!-- My Certificates Preview -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-certificate"/></svg>My Certificates</h2>
                </div>
                <div class="card-body" id="certificatesList">
                    <p style="text-align: center; color: var(--text-secondary); padding: 20px;">No certificates yet</p>
                </div>
                <div class="view-all-link">
                    <a href="student-certificates.html">View All Certificates →</a>
                </div>
            </div>

            <!-- Training Materials Preview -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-book"/></svg>Training Materials</h2>
                </div>
                <div class="card-body" id="trainingMaterialsList">
                    <p style="text-align: center; color: var(--text-secondary); padding: 20px;">No training materials available</p>
                </div>
                <div class="view-all-link">
                    <a href="student-materials.html">View All Materials →</a>
                </div>
            </div>
            
            <div class="content-grid">
                <div class="card">
                    <div class="card-header">
                        <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-calendar"/></svg>My Upcoming Classes</h2>
                    </div>
                    <div class="card-body">
                        <div class="class-list" id="upcomingClasses">
                            <p style="text-align: center; color: var(--text-secondary); padding: 20px;">No upcoming classes scheduled</p>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-dashboard"/></svg>My Statistics</h2>
                    </div>
                    <div class="card-body">
                        <div class="stats-grid" style="grid-template-columns: 1fr;">
                            <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-calendar"/></svg></div>
                                <div class="stat-info">
                                    <h3>Classes This Month</h3>
                                    <p class="stat-value" id="classesThisMonth">0</p>
                                </div>
                            </div>
                            
                            <div class="stat-card">
                        <div class="stat-icon"><svg width="28" height="28"><use href="#icon-dashboard"/></svg></div>
                                <div class="stat-info">
                                    <h3>Training Hours</h3>
                                    <p class="stat-value" id="trainingHours">0h</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <!-- Image Viewer Modal -->
    <div id="imageViewerModal" class="image-viewer-modal">
        <span class="image-viewer-close" onclick="closeImageViewer()">&times;</span>
        <img id="imageViewerContent" class="image-viewer-content" alt="Full size image">
    </div>
    
    <script src="./seed-data.js"></script>
    <script src="./student-dashboard-integration.js"></script>
    <script src="./profile-sync.js"></script>
    <script src="./student-dashboard-profile.js"></script>
    <script type="module" src="./script.js"></script>
    <script type="module" src="./online-status.js"></script>
    <script type="module" src="./messages.js"></script>
    <script>
        // Check if user is student
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser || currentUser.role !== 'student') {
            alert('Access denied! This page is for students only.');
            window.location.href = 'index.html';
        }

        // Image viewer functions
        window.openImageViewer = function(imageSrc) {
            const modal = document.getElementById('imageViewerModal');
            const img = document.getElementById('imageViewerContent');
            modal.classList.add('active');
            img.src = imageSrc;
        };
        
        window.closeImageViewer = function() {
            const modal = document.getElementById('imageViewerModal');
            modal.classList.remove('active');
        };
        
        // Close modal when clicking outside the image
        document.getElementById('imageViewerModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeImageViewer();
            }
        });
        
        // Load student profile
        function loadStudentProfile() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const savedUsers = JSON.parse(localStorage.getItem('users') || '{}');
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            
            if (currentUser) {
                document.getElementById('studentName').textContent = `Welcome, ${currentUser.name}`;
                document.getElementById('studentFullName').textContent = currentUser.name;
                
                // Find student data
                const studentData = students.find(s => 
                    s.username === currentUser.username || 
                    s.email === currentUser.email ||
                    s.id === currentUser.id
                );
                
                if (studentData) {
                    document.getElementById('studentBeltRank').textContent = studentData.beltRank || 'White Belt';
                    document.getElementById('studentClass').textContent = studentData.class || 'Beginner';
                    document.getElementById('memberSince').textContent = studentData.joinDate ? 
                        new Date(studentData.joinDate).toLocaleDateString('en-US', { month: 'long', year: 'numeric' }) : 
                        'January 2024';
                    document.getElementById('currentBelt').textContent = studentData.beltRank || 'White Belt';
                    
                    // Calculate next belt
                    const beltProgression = ['White', 'Yellow', 'Green', 'Blue', 'Red', 'Black'];
                    const currentBeltIndex = beltProgression.indexOf(studentData.beltRank || 'White');
                    const nextBeltName = currentBeltIndex < beltProgression.length - 1 ? 
                        beltProgression[currentBeltIndex + 1] + ' Belt' : 
                        'Black Belt (Achieved!)';
                    document.getElementById('nextBelt').textContent = nextBeltName;
                    
                    // Set progress (example: 60%)
                    document.getElementById('beltProgress').style.width = '60%';
                    
                    // Update profile image from studentData
                    if (studentData.profilePhoto) {
                        document.getElementById('studentAvatar').innerHTML = `<img src="${studentData.profilePhoto}" alt="${studentData.name}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
                    }
                }
                
                if (savedUsers.student && savedUsers.student.image) {
                    document.getElementById('studentAvatar').innerHTML = `<img src="${savedUsers.student.image}" alt="Student" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`;
                }
            }
        }
        
        // Load announcements with clickable images
        function loadAnnouncements() {
            const announcements = JSON.parse(localStorage.getItem('announcements') || '[]');
            const announcementsList = document.getElementById('announcementsList');
            
            if (announcements.length === 0) {
                announcementsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No announcements yet</p>';
                return;
            }
            
            announcementsList.innerHTML = announcements.map(announcement => `
                <div class="announcement-card">
                    <div class="announcement-header">
                    <span class="announcement-icon"><svg width="18" height="18"><use href="#icon-message"/></svg></span>
                        <h3 class="announcement-title">${announcement.title}</h3>
                    </div>
                    ${announcement.image ? `<img src="${announcement.image}" alt="${announcement.title}" class="announcement-image" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin: 15px 0;" onclick="openImageViewer('${announcement.image}')" title="Click to view full size">` : ''}
                    <p class="announcement-description">${announcement.description}</p>
                    <p class="announcement-date"><svg width="16" height="16" style="margin-right:6px; vertical-align:middle;"><use href="#icon-calendar"/></svg>${announcement.date}</p>
                </div>
            `).join('');
            const imgs = announcementsList.querySelectorAll('.announcement-image');
            imgs.forEach(img => {
                img.addEventListener('click', () => openImageViewer(img.src));
            });
        }

        // Refresh immediately when admin posts an announcement
        window.addEventListener('announcementPosted', loadAnnouncements);

        // Load student certificates (preview - show max 3)
        function loadCertificates() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const certificates = JSON.parse(localStorage.getItem('certificates') || '[]');
            const students = JSON.parse(localStorage.getItem('students') || '[]');
            
            // Find student data
            const studentData = students.find(s => 
                s.username === currentUser.username || 
                s.email === currentUser.email ||
                s.id === currentUser.id
            );
            
            let myCertificates = [];
            if (studentData) {
                myCertificates = certificates.filter(cert => String(cert.studentId) === String(studentData.id));
            } else {
                const currentName = currentUser?.name;
                myCertificates = certificates.filter(cert => 
                    (cert.studentName && currentName && cert.studentName === currentName) ||
                    (currentUser?.id && String(cert.studentId) === String(currentUser.id))
                );
            }
            
            const certificatesList = document.getElementById('certificatesList');
            const certificatesCount = document.getElementById('certificatesCount');
            
            certificatesCount.textContent = myCertificates.length;
            
            if (myCertificates.length === 0) {
                certificatesList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No certificates yet</p>';
                return;
            }
            
            // Show only first 3 certificates
            const previewCerts = myCertificates.slice(0, 3);
            certificatesList.innerHTML = previewCerts.map(cert => `
                <div class="certificate-item" onclick="window.location.href='student-certificates.html'">
                    <span class="certificate-icon"><svg width="24" height="24"><use href="#icon-trophy"/></svg></span>
                    <div class="certificate-info">
                        <h4>${cert.title}</h4>
                        <p>Awarded: ${cert.uploadDate}</p>
                    </div>
                </div>
            `).join('');
        }

        // Load training materials (preview - show max 3)
        function loadTrainingMaterials() {
            const materials = JSON.parse(localStorage.getItem('trainingMaterials') || '[]');
            const materialsList = document.getElementById('trainingMaterialsList');
            const materialsCount = document.getElementById('materialsCount');
            
            materialsCount.textContent = materials.length;
            
            if (materials.length === 0) {
                materialsList.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No training materials available</p>';
                return;
            }
            
            const typeIcons = {
                'video': '<svg width="24" height="24"><use href="#icon-book"/></svg>',
                'pdf': '<svg width="24" height="24"><use href="#icon-book"/></svg>',
                'guide': '<svg width="24" height="24"><use href="#icon-book"/></svg>',
                'other': '<svg width="24" height="24"><use href="#icon-book"/></svg>'
            };
            
            // Show only first 3 materials
            const previewMaterials = materials.slice(0, 3);
            materialsList.innerHTML = previewMaterials.map(material => `
                <div class="material-item" onclick="window.location.href='student-materials.html'">
                    <span class="material-icon">${typeIcons[material.type] || '<svg width="24" height="24"><use href="#icon-book"/></svg>'}</span>
                    <div class="material-info">
                        <h4>${material.title}</h4>
                        <p>${material.description}</p>
                        <p style="font-size: 12px; color: var(--text-secondary);">Uploaded: ${material.uploadDate}</p>
                    </div>
                </div>
            `).join('');
        }

        // This function will be overridden by student-dashboard-integration.js
        function loadUpcomingClasses() {
            const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
            const upcomingClasses = document.getElementById('upcomingClasses');
            
            if (schedules.length === 0) {
                upcomingClasses.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No upcoming classes scheduled</p>';
                return;
            }
            
            upcomingClasses.innerHTML = schedules.map(schedule => `
                <div class="class-item">
                    <div class="class-time"><svg width="16" height="16" style="margin-right:6px; vertical-align:middle;"><use href="#icon-calendar"/></svg>${schedule.uploadDate}</div>
                    <div class="class-info">
                        <h4>${schedule.title}</h4>
                        <p>${schedule.description}</p>
                    </div>
                </div>
            `).join('');
        }
        
        // Load on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadStudentProfile();
            loadAnnouncements();
            loadCertificates();
            loadTrainingMaterials();
            loadUpcomingClasses();
            
            // Refresh data every 30 seconds
            setInterval(() => {
                loadAnnouncements();
                loadCertificates();
                loadTrainingMaterials();
                loadUpcomingClasses();
            }, 30000);
        });
    </script>
    <script src="./sponsors.js"></script>
    <script src="./sponsors-carousel.js"></script>
    
</body>

</html>
