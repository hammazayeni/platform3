<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./assets/logo/taekwondo-sbeitla.png" type="image/png" sizes="50x50">
    <title>Class Schedule - Taekwondo Sbeitla</title>
    <link rel="stylesheet" href="./style.css">
    <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <symbol id="icon-taekwondo" viewBox="0 0 24 24"><path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2M15.9 8.1C15.5 7.7 14.8 7.7 14.4 8.1L12 10.5L9.6 8.1C9.2 7.7 8.5 7.7 8.1 8.1C7.7 8.5 7.7 9.2 8.1 9.6L10 11.5V15L8 20H10L12 16L14 20H16L14 15V11.5L15.9 9.6C16.3 9.2 16.3 8.5 15.9 8.1M6 18C6 18 4 13 4 11C4 9.9 4.9 9 6 9V18M18 18V9C19.1 9 20 9.9 20 11C20 13 18 18 18 18Z" fill="currentColor"/></symbol>
            <symbol id="icon-dashboard" viewBox="0 0 24 24"><path d="M3 13H11V3H3M3 21H11V15H3M13 21H21V11H13M13 3V9H21V3" fill="currentColor"/></symbol>
            <symbol id="icon-certificate" viewBox="0 0 24 24"><path d="M4 3C2.9 3 2 3.9 2 5V15C2 16.1 2.9 17 4 17H11V15H4V5H20V15H13V17H20C21.1 17 22 16.1 22 15V5C22 3.9 21.1 3 20 3H4M12 17L9 20V23L12 21L15 23V20L12 17Z" fill="currentColor"/></symbol>
            <symbol id="icon-book" viewBox="0 0 24 24"><path d="M18 2H12V9L9.5 7.5L7 9V2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V4C20 2.9 19.1 2 18 2Z" fill="currentColor"/></symbol>
            <symbol id="icon-message" viewBox="0 0 24 24"><path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H6L4 18V4H20V16M7 9H17V11H7V9M7 6H17V8H7V6M7 12H14V14H7V12Z" fill="currentColor"/></symbol>
            <symbol id="icon-calendar" viewBox="0 0 24 24"><path d="M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3 4.9 3 6V20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4M19 20H5V10H19V20M19 8H5V6H19V8M7 12H12V17H7V12Z" fill="currentColor"/></symbol>
            <symbol id="icon-logout" viewBox="0 0 24 24"><path d="M16 17V14H9V10H16V7L21 12L16 17M14 2C15.1 2 16 2.9 16 4V6H14V4H5V20H14V18H16V20C16 21.1 15.1 22 14 22H5C3.9 22 3 21.1 3 20V4C3 2.9 3.9 2 5 2H14Z" fill="currentColor"/></symbol>
            <symbol id="icon-users" viewBox="0 0 24 24"><path d="M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z" fill="currentColor"/></symbol>
        </defs>
    </svg>
</head>

<body>
    <div class="dashboard-layout">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo bounce-animation"><img class="logo-img" src="./assets/logo/taekwondo-sbeitla.png" alt="Taekwondo Sbeitla" /></div>
                <h2>Taekwondo Sbeitla</h2>
            </div>
            
            <nav class="sidebar-nav" id="sidebarNav">
                <a href="admin-dashboard.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-dashboard"/></svg></span>
                    <span>Dashboard</span>
                </a>
                <a href="student-management.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-users"/></svg></span>
                    <span>Students</span>
                </a>
                <a href="parent-management.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-users"/></svg></span>
                    <span>Parents</span>
                </a>
                <a href="pending-registrations.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-register"/></svg></span>
                    <span>Registrations</span>
                </a>
                <a href="messages.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-message"/></svg></span>
                    <span>Messages</span>
                    <span class="message-badge" id="sidebarMessageBadge"></span>
                </a>
                <a href="attendance.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-check"/></svg></span>
                    <span>Attendance</span>
                </a>
                <a href="class-schedule.html" class="nav-item active">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-calendar"/></svg></span>
                    <span>Schedule</span>
                </a>
                <a href="settings.html" class="nav-item">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-settings"/></svg></span>
                    <span>Settings</span>
                </a>
                <a href="index.html" class="nav-item logout">
                    <span class="icon"><svg width="20" height="20"><use href="#icon-logout"/></svg></span>
                    <span>Logout</span>
                </a>
            </nav>
        </aside>
        
        <main class="main-content">
            <header class="page-header">
            <h1><svg width="24" height="24" style="margin-right:8px; vertical-align:middle;"><use href="#icon-calendar"/></svg>Class Schedule</h1>
                <div class="user-info">
                    <span>Week of November 10 - 16, 2025</span>
                </div>
            </header>

            <!-- Uploaded Schedules Section -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-dashboard"/></svg>Official Schedules</h2>
                </div>
                <div class="card-body">
                    <div id="uploadedSchedulesDisplay">
                        <p style="text-align: center; color: var(--text-secondary); padding: 20px;">No schedules uploaded yet</p>
                    </div>
                </div>
            </div>

            <!-- Daily Classes (from admin-managed daily classes) -->
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-calendar"/></svg>Daily Classes</h2>
                </div>
                <div class="card-body">
                    <div id="dailyClassesDisplay"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h2><svg width="18" height="18" style="margin-right:6px;"><use href="#icon-calendar"/></svg>Weekly Schedule</h2>
                </div>
                <div class="card-body">
                    <div id="weeklyScheduleDisplay"></div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="./class-manager.js"></script>
    <script type="module" src="./script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            const nav = document.getElementById('sidebarNav');
            if (!currentUser || !nav) return;
            if (currentUser.role === 'student') {
                nav.innerHTML = `
                    <a href="student-dashboard.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-dashboard"/></svg></span>
                        <span>Dashboard</span>
                    </a>
                    <a href="student-certificates.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-certificate"/></svg></span>
                        <span>My Certificates</span>
                    </a>
                    <a href="student-materials.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-book"/></svg></span>
                        <span>Training Materials</span>
                    </a>
                    <a href="messages.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-message"/></svg></span>
                        <span>Messages</span>
                        <span class="message-badge" id="sidebarMessageBadge"></span>
                    </a>
                    <a href="class-schedule.html" class="nav-item active">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-calendar"/></svg></span>
                        <span>Schedule</span>
                    </a>
                    <a href="index.html" class="nav-item logout">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-logout"/></svg></span>
                        <span>Logout</span>
                    </a>
                `;
            } else if (currentUser.role === 'parent') {
                nav.innerHTML = `
                    <a href="parent-dashboard.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-dashboard"/></svg></span>
                        <span>Dashboard</span>
                    </a>
                    <a href="messages.html" class="nav-item">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-message"/></svg></span>
                        <span>Messages</span>
                        <span class="message-badge" id="sidebarMessageBadge"></span>
                    </a>
                    <a href="class-schedule.html" class="nav-item active">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-calendar"/></svg></span>
                        <span>Schedule</span>
                    </a>
                    <a href="index.html" class="nav-item logout">
                        <span class="icon"><svg width="20" height="20"><use href="#icon-logout"/></svg></span>
                        <span>Logout</span>
                    </a>
                `;
            }
        });
        // Load uploaded schedules
        function loadUploadedSchedules() {
            const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
            const container = document.getElementById('uploadedSchedulesDisplay');
            
            if (!container) return;
            
            if (schedules.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 20px;">No schedules uploaded yet</p>';
                return;
            }
            
                    container.innerHTML = schedules.map(schedule => `
                <div class="material-item" style="margin-bottom: 15px;">
                    <span class="material-icon"><svg width="20" height="20"><use href="#icon-calendar"/></svg></span>
                    <div class="material-info">
                        <h4>${schedule.title}</h4>
                        <p>${schedule.description}</p>
                        <p style="font-size: 12px; color: var(--text-secondary);">Uploaded: ${schedule.uploadDate}</p>
                    </div>
                    <button class="btn btn-primary btn-small" onclick="viewSchedule(${schedule.id})">View</button>
                </div>
            `).join('');
        }
        
        // View schedule
        window.viewSchedule = function(id) {
            const schedules = JSON.parse(localStorage.getItem('schedules') || '[]');
            const schedule = schedules.find(s => s.id === id);
            
            if (!schedule) {
                alert('Schedule not found');
                return;
            }
            
            // Open schedule in new window
            const newWindow = window.open('', '_blank');
            if (schedule.fileName.toLowerCase().endsWith('.pdf')) {
                newWindow.document.write(`
                    <html>
                        <head><title>${schedule.title}</title></head>
                        <body style="margin: 0;">
                            <embed src="${schedule.fileData}" type="application/pdf" width="100%" height="100%" />
                        </body>
                    </html>
                `);
            } else {
                newWindow.document.write(`
                    <html>
                        <head><title>${schedule.title}</title></head>
                        <body style="margin: 0; display: flex; justify-content: center; align-items: center; background: #000;">
                            <img src="${schedule.fileData}" style="max-width: 100%; max-height: 100vh;" />
                        </body>
                    </html>
                `);
            }
        };
        
        // Render dynamic schedules
        document.addEventListener('DOMContentLoaded', function() {
            const currentUser = JSON.parse(localStorage.getItem('currentUser'));
            if (!currentUser) return;

            loadUploadedSchedules();

            if (typeof loadTodayClasses === 'function') {
                loadTodayClasses('dailyClassesDisplay');
            }
            if (typeof loadWeeklySchedule === 'function') {
                loadWeeklySchedule('weeklyScheduleDisplay');
            }

            setInterval(() => {
                loadUploadedSchedules();
                if (typeof loadTodayClasses === 'function') {
                    loadTodayClasses('dailyClassesDisplay');
                }
                if (typeof loadWeeklySchedule === 'function') {
                    loadWeeklySchedule('weeklyScheduleDisplay');
                }
            }, 30000);
        });
    </script>
</body>

</html>
 
